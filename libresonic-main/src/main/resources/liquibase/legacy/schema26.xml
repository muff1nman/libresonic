<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
    <changeSet id="schema26_001" author="muff1nman">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="1">select count(*) from VERSION where VERSION = 2</sqlCheck>
        </preConditions>
        <insert tableName="VERSION">
            <column name="VERSION" valueNumeric="2" />
        </insert>
        <rollback>
            <delete tableName="VERSION" >
                <where>VERSION = 2</where>
            </delete>
        </rollback>
    </changeSet>
    <changeSet id="schema26_002" author="muff1nman">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="MUSIC_FOLDER" />
            </not>
        </preConditions>
        <createTable tableName="MUSIC_FOLDER">
            <column name="ID" type="int" autoIncrement="true" >
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="PATH" type="${varchar_type}" >
                <constraints nullable="false" />
            </column>
            <column name="NAME" type="${varchar_type}" >
                <constraints nullable="false" />
            </column>
            <column name="ENABLED" type="boolean" >
                <constraints nullable="false" />
            </column>
        </createTable>
        <insert tableName="MUSIC_FOLDER">
            <column name="PATH" value="${defaultMusicFolder}"/>
            <column name="NAME" value="Music"/>
            <column name="ENABLED" valueBoolean="true" />
        </insert>
        <rollback>
            <dropTable tableName="MUSIC_FOLDER" />
        </rollback>
    </changeSet>
    <changeSet id="schema26_003" author="muff1nman">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="MUSIC_FILE_INFO" />
            </not>
        </preConditions>
        <createTable tableName="MUSIC_FILE_INFO">
            <column name="ID" type="int" autoIncrement="true">
                <constraints primaryKey="true" />
            </column>
            <column name="PATH" type="${varchar_type}" >
                <constraints nullable="false" />
            </column>
            <column name="RATING" type="int" />
            <column name="COMMENT" type="${varchar_type}" />
            <column name="PLAY_COUNT" type="int" />
            <column name="LAST_PLAYED" type="datetime" />
        </createTable>
        <createIndex tableName="MUSIC_FILE_INFO" indexName="idx_music_file_info_path">
            <column name="PATH"/>
        </createIndex>
        <rollback>
            <dropTable tableName="MUSIC_FILE_INFO" />
        </rollback>
    </changeSet>
    <changeSet id="schema26_004" author="muff1nman">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="INTERNET_RADIO" />
            </not>
        </preConditions>
        <createTable tableName="INTERNET_RADIO">
            <column name="ID" type="int" autoIncrement="true" >
                <constraints primaryKey="true" />
            </column>
            <column name="NAME" type="${varchar_type}" >
                <constraints nullable="false" />
            </column>
            <column name="STREAM_URL" type="${varchar_type}" >
                <constraints nullable="false" />
            </column>
            <column name="HOMEPAGE_URL" type="${varchar_type}" />
            <column name="ENABLED" type="boolean" >
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="INTERNET_RADIO" />
        </rollback>
    </changeSet>
    <changeSet id="schema26_005" author="muff1nman">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="PLAYER" />
            </not>
        </preConditions>
        <createTable tableName="PLAYER">
            <column name="ID" type="int" autoIncrement="true">
                <constraints primaryKey="true" />
            </column>
            <column name="NAME" type="${varchar_type}" />
            <column name="TYPE" type="${varchar_type}" />
            <column name="USERNAME" type="${varchar_type}" />
            <column name="IP_ADDRESS" type="${varchar_type}" />
            <column name="AUTO_CONTROL_ENABLED" type="boolean" >
                <constraints nullable="false" />
            </column>
            <column name="LAST_SEEN" type="datetime" />
            <column name="COVER_ART_SCHEME" type="${varchar_type}" >
                <constraints nullable="false" />
            </column>
            <column name="TRANSCODE_SCHEME" type="${varchar_type}" >
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="PLAYER" />
        </rollback>
    </changeSet>
    <changeSet id="schema26_006" author="muff1nman">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="PLAYER" columnName="DYNAMIC_IP" />
            </not>
        </preConditions>
        <addColumn tableName="PLAYER">
            <column name="DYNAMIC_IP" type="boolean" defaultValueBoolean="true">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <rollback>
            <dropColumn tableName="PLAYER" columnName="DYNAMIC_IP"/>
        </rollback>
    </changeSet>
    <changeSet id="schema26_007" author="muff1nman">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="1">select count(*) from ROLE where ID = 6</sqlCheck>
        </preConditions>
        <insert tableName="ROLE">
            <column name="ID" valueNumeric="6"/>
            <column name="NAME" value="comment" />
        </insert>
        <sql>
            insert into "USER_ROLE"(USERNAME, ROLE_ID)
            select distinct u.USERNAME, 6 from "USER" u, "USER_ROLE" ur
            where u.USERNAME = ur.USERNAME and ur.ROLE_ID in (1, 5)
        </sql>
        <rollback>
            <delete tableName="USER_ROLE" >
                <where>ROLE_ID = 6</where>
            </delete>
            <delete tableName="ROLE">
                <where>ID = 6</where>
            </delete>
        </rollback>
    </changeSet>
</databaseChangeLog>
